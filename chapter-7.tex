\chapter{Влияние переменного запаздывания}\label{lab7}

Следующим видом запаздывания, которое мы рассмотрим, будет
переменное. Его основное отличие заключается в том, что
величина задержки, на которую мы смотрим в прошлое,
меняется от текущего момента времени. Например,
в нашем уравнении \eqref{lab7:eq1} величина задержки будет
$\tau*\sin(\frac{2t}{T})$, тут $\tau$ - это максимальная
величина на которую может потребоваться заглянуть в историю,
и соответственно в зависимости от $\sin(\frac{2t}{T})$ мы будем
брать то близкие к текущему моменту времени значения фазовой
переменной, то далекие. Коэффициент у синуса $2/T$ был выбран для того,
что бы период изменения был пропорционален рассматриваемому
отрезку времени.

\begin{equation}\label{lab7:eq1}
  \begin{cases}
      &\dot{y_1} = y_2 + \alpha * y_1(t-\tau*\sin(\frac{2t}{T}))\\
      &\dot{y_2} = -3y_2^3\ + \nu y_2 - y_1
  \end{cases}
\end{equation}

В связи с тем, что момент времени выбирается теперь в каждый момент
времени, нам требуется способ задания фазовой переменной "из прошлого":

\begin{definition}
    $x_t(\cdot) = \{x(t + s), -\tau \leq s \leq 0 \}$ --
    \textbf{функция-предыстории}, фазового вектора в момент времени $t$.
\end{definition}

Данное определение удобно при теоретическом рассмотрении модели.
Чтобы представить его в нашей программе нам понадобится интерполяция
этой предыстории.

\begin{definition}
    Интерполяцией $u_t$, назовем дискретную функцию,
    описывающую функцию-предыстории модели.
\end{definition}

В нашем случае, будет достаточно
простой кусочно-линейной интерполяции (Уравнение \eqref{lab7:eq2}).

\begin{equation}\label{lab7:eq2}
    u(t) = \begin{cases}
        &x_{i-1}, t \in [t_{i-1}, t_i) \\
        &y(t), t \leq t_0
    \end{cases}
\end{equation}

И метод \textit{Эйлера с кусочно постоянной интерполяцией}
будет выглядеть следующим образом ($t = ih$):

\begin{equation}\label{lab7:euler}
  \begin{cases}
  &y_1^{i+1} = y_1^i + h(y_2^i + \alpha * u_{1_t}(ih-\tau*\sin(\frac{2ih}{T}))\\
  &y_2^{i+1} = y_1^i + h(-3(y_2^i)^3\ + \nu y_2^i - y_1^i)
  \end{cases}
\end{equation}

Начальные значения берем аналогично предыдущей работе \ref{lab6}.

\myImage{($\alpha = -0.727$) Решения начинают сильно расходиться по краям}{7_y1_-0_727}{lab7:y1:1}
\myImage{($\alpha = -0.42$) Цикл искривляется в спираль}{7_y1_-0_42}{lab7:y1:2}
\myImage{($\alpha = 0.379$) Оба решения построились. Спиралевидно сходятся внутри цикла}{7_y1_0_379}{lab7:y1:4}
\myImage{($\alpha = 0.38$) Второе решение перестало строится. Первое ведет себя спиралевидно}{7_y1_0_38}{lab7:y1:3}
\myImage{($\alpha = 0.691$)У второго решения видны жесткие изменения системы. Дальше второе решение перестало строиться}{7_y1_0_691}{lab7:y1:5}
\clearpage

Таким образом, при добавлении к системе переменного запаздывания
нам даже не удалось посмотреть влияния его на систему при
$\alpha \geq 1$, то есть в нашем случае его воздействие на
систему оказалось гораздо сильнее, чем постоянная задержка.

В приложении \ref{app:changeable} можно посмотреть, как
такое запаздывание влияет при добавлении его ко второй
переменной системы.
