\chapter{Влияние постоянного запаздывания}\label{lab6}

Начиная с этой главы мы познакомимся с разными видами
дифференциальных уравнений с запаздыванием, называемые
также функционально-дифференциальными уравнениями (ФДУ),
которые являются обобщением обыкновенных дифференциальных
уравнений.

\begin{definition}
    Дифференциальным уравнением с постоянным запаздыванием,
    мы будем называть уравнение вида:
    \begin{equation*}
        \begin{cases}
            &\dot{x} = f(t, x(t), x(t - \tau)) \\
            &x(t_0) = x_0 \\
            &x_{t_0}(\cdot) = \begin{Bmatrix}y_0(t); t \in [t_0 -\tau; t_0)\end{Bmatrix}
        \end{cases}
    \end{equation*}
\end{definition}

Посмотрев на него, можно выделить основные особенности от обычных дифференциальных
уравнений, помимо зависимости от $t$ и $x$, у нас появляется зависимость от
значения фазовой переменной в момент $(t-\tau)$. Так же
понадобилось задать значение фазовой переменной на $[t_0 -\tau; t_0)$
(обозначенное $x_{t_0}(\cdot)$),
в противном случае само уравнение системы, например во время $t=0$,
нельзя трактовать однозначно.

В дальнейшем, рассматривая разные виды запаздывания нам
будет удобно пользоваться определением \textit{функции предыстории}
-- тех значений фазовой переменной, которые влияют на текущее
состояние системы:

\begin{definition}
    $x_t(\cdot) = \{x(t + s), -\tau \leq s \leq 0 \}$ --
    \textbf{функция-предыстории}, фазового вектора в момент времени $t$.
\end{definition}

\section{Метод Эйлера с кусочно постоянной интерполяцией}
% 2. Не описаны численные методы, их можно извлечь лишь косвенно из кодов программ.
Для того, чтобы промоделировать такую систему нам потребуется
модернизировать наш метод Эйлера. Суть модификации заключается
в том, как мы будем считать элемент $x_t(t - \tau)$ в нашей
дискретной схеме подсчета.

\begin{definition}
    Интерполяцией $u_t$, назовем дискретную функцию,
    описывающую функцию-предыстории модели.
\end{definition}

Таким образом, интерполяция - это дискретное приближение
функции предыстории $x_t$. Понятно, что интерполяцию можно
построить разными способами, и более того, это может влиять
на сходимость нашего метода. В нашем случае, будет достаточно
простой кусочно-линейной интерполяции (Уравнение \eqref{lab6:eq2}).

\begin{equation}\label{lab6:eq2}
    u(t) = \begin{cases}
        &x_{i-1}, t \in [t_{i-1}, t_i) \\
        &y(t), t \leq t_0
    \end{cases}
\end{equation}

В таком виде интерполяция задана для всего промежутка времени
$[t_0-\tau, T]$, мы можем легко сузить
эту интерполяцию на отрезок $[t-\tau, t]$, получив тем самым
интерполяцию предыстории $x_t$, а значит и выразить
слагаемое $x_t(t - \tau)$, через эту интерполяцию.
Тем самым мы получили модификацию метода Эйлера, называемую
\textit{методом Эйлера с кусочно постоянной интерполяцией}.

\begin{theorem}
    Метод Эйлера с кусочно постоянной интерполяцией имеет порядок
    сходимости $p = 1$.
\end{theorem}


% 1. Начиная с раздела 6.1 встречаются конкретные эксперименты с системами с запаздыванием,
% поэтому нужно указывать начальные условия, в том числе и функциональные.

\section{Численный эксперимент}

Проведем первый эксперимент с постоянным запаздыванием.
Для этого, введем в нашу систему слагаемое
$\alpha * y_1(t-\tau)$ (Ур. \eqref{lab6:eq2}). При параметре
$\alpha = 0$ оно не влияет на систему, следовательно мы будем
наблюдать наш предельный цикл. Постепенно изменяя этот параметр,
мы будем наблюдать на изменения характера системы.

\begin{equation}\label{lab6:eq3}
\begin{cases}
    &\dot{y_1} = y_2 + \alpha * y_1(t-\tau)\\
    &\dot{y_2} = -3y_2^3\ + \nu y_2 - y_1
\end{cases}
\end{equation}

В прошлых экспериментах мы рассматривали два решения: от точки
$(0.1, 0.1)$ и от точки $(2, 2)$. Теперь же нам еще нужна
предыстория нашей системы, поэтому мы просто возьмем ее константной
(ур. \eqref{lab6:eq4} и \eqref{lab6:eq5}).

\begin{equation}\label{lab6:eq4}
  \begin{cases}
    &y_{1_{t_0}} = 0.1, t \in [-\tau, 0]\\
    &y_{2_{t_0}} = 0.1, t \in [-\tau, 0]
  \end{cases}
\end{equation}

\begin{equation}\label{lab6:eq5}
  \begin{cases}
    &y_{1_{t_0}} = 2, t \in [-\tau, 0]\\
    &y_{2_{t_0}} = 2, t \in [-\tau, 0]
  \end{cases}
\end{equation}

Стоит отметить, модернизацию нашей программы в техническом
виде, с помощью слайдера оказалось неудобным отлаживать
подбор необходимого параметра. Поэтому, чтобы упростить
эксперименты и не перезапускать программу, вместо слайдера
был поставлен \textmd{TextBox} - поле для ввода текста, куда мы
можем ввести любое, необходимое нам, значение (пересчет
графика произойдет при нажатии на клавишу \textmd{Enter}).
При желании, с подробностями использования этого виджета
можно ознакомиться в приложении.

\myImage{($\alpha = -0.65$) Решение от точки (0.1, 0.1) хаотично расходится от центра.
Решение от точки (2, 2) не смогло построится}{6_y1_-0_65}{lab6:y1:1}
\myImage{($\alpha = -0.649$) Оба решения построились. Отчетливо наблюдается жесткость
системы, цикл сохранился, но об изолированности говорить не приходится}{6_y1_-0_649}{lab6:y1:2}
\myImage{($\alpha = 0.426$) Решение все еще сходится к циклу, но постепенно разбалтывается}{6_y1_0_426}{lab6:y1:3}
\myImage{($\alpha = 0.427$) Второе решение перестало моделироваться. Первое все еще сходится к циклу}{6_y1_0_427}{lab6:y1:4}
\myImage{($\alpha = 1$) У первого решения появляются две петельки и траектория становится более хаотична}{6_y1_1_0}{lab6:y1:5}
\clearpage
\myImage{($\alpha = 1.24$) Первое решение хаотично изменятся в пределах цикла}{6_y1_1_14}{lab6:y1:6}

Нам не удавалось сильно изменить параметр $\alpha$:
сразу же начинали расходиться решения (или решение);
проявлялось, своего рода, хаотичное поведение; исчезали циклы.
То есть мы увидели, как сильно влияет на поведение системы
даже самая простая, в плане понимания, задержка.

При добавлении подобного слагаемого во второе уравнение можно
пронаблюдать другие бифуркации. При желании, эти эксперименты
можно посмотреть в Приложении \ref{app:const}.
